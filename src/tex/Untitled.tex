""" Test example of LAR of a 2-complex with non-contractible and non-manifold cells"""
from larlib import *
sys.path.insert(0, 'test/py/triangulation/')
from test09 import *

def nonmanifold2manifold(region):
    edgenumber = len(CAT(region))
    vertexnumber = len(set(CAT(region)))
    if vertexnumber < edgenumber:
        # non-manifold case
        print "non-manifold =",region
    else:
        # manifold case
        print "manifold =",region
        return region    

model = V,FV,EV

bmatrix = boundary1(FV,EV,VV)
boundaryOperator = chain2BoundaryChain(bmatrix)
unitChain = [0]*len(FV)
boundingEdges = []
n = len(FV)
for k in range(n):
	unitChain[(k-1)%n] = 0
	unitChain[k] = 1
	frontier = boundaryOperator(unitChain)
	boundingEdges += [frontier]

brep = [boundaryCycles(frontier,EV)[1] for frontier in boundingEdges]
manifolds = [nonmanifold2manifold(region) for region in brep]
polylines = [[[V[v] for v in cycle] for cycle in region] for region in brep]
VIEW(STRUCT(AA(STRUCT)(AA(AA(POLYLINE))(polylines))))



