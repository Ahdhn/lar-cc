""" Correction to boundary operator """
from larlib import *

V = [[0.0,0.0,0.0],[0.0,0.0,1.0],[0.0,1.0,0.0],[0.0,1.0,1.0],[1.0,0.0,0.0],
[1.0,0.0,1.0],[1.0,1.0,0.0],[1.0,1.0,1.0],[2.0,0.0,0.0],[2.0,0.0,1.0],
[2.0,1.0,0.0],[2.0,1.0,1.0],[0.5,0.25,0.25],[0.5,0.25,0.75],[0.5,0.75,
0.25],[0.5,0.75,0.75],[1.0,0.25,0.25],[1.0,0.25,0.75],[1.0,0.75,0.25],
[1.0,0.75,0.75],[1.5,0.25,0.25],[1.5,0.25,0.75],[1.5,0.75,0.25],[1.5,
0.75,0.75]]

CV = [(16,17,18,19,20,21,22,23),(4,5,6,7,8,9,10,11,16,17,18,19,20,21,
22,23),(12,13,14,15,16,17,18,19),(0,1,2,3,4,5,6,7,12,13,14,15,16,
17,18,19)]

FV = [(0,2,4,6),(12,13,14,15),(4,6,8,10),(0,1,4,5),(16,17,18,19),(4,5,6,
7,16,17,18,19),(17,19,21,23),(16,17,20,21),(0,1,2,3),(18,19,22,23),
(14,15,18,19),(1,3,5,7),(12,13,16,17),(12,14,16,18),(13,15,17,19),
(4,5,8,9),(2,3,6,7),(16,18,20,22),(5,7,9,11),(6,7,10,11),(8,9,10,11),
(20,21,22,23)]

EV = [[0,1],[2,3],[4,5],[6,7],[8,9],[10,11],[0,2],[1,3],[4,6],[5,7],
[8,10],[9,11],[0,4],[1,5],[2,6],[3,7],[4,8],[5,9],[6,10],[7,11],[12,13],
[14,15],[16,17],[18,19],[20,21],[22,23],[12,14],[13,15],[16,18],[17,19],
[20,22],[21,23],[12,16],[13,17],[14,18],[15,19],[16,20],[17,21],[18,22],
[19,23]]

csrBoundaryMat = boundary(CV,FV)
print "wrong boundary matrix =",csrBoundaryMat.todense()
csrBoundaryMat = larUnsignedBoundary2(CV,FV,EV)
print "right boundary matrix =",csrBoundaryMat.todense()

VV = AA(LIST)(range(len(V)))
submodel = STRUCT(MKPOLS((V,EV)))
VIEW(larModelNumbering(1,1,1)(V,[VV,EV,FV,CV],submodel,.5)) 
